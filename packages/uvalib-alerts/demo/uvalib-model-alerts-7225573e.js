import e from"./uvalib-model-realtime-database-5f0d0bc2.js";class t extends e{static get observedAttributes(){return super.observedAttributes.concat([])}get seen(){const e=JSON.parse(localStorage.getItem("uvalib-alerts-seen"));return Array.isArray(e)?e:[]}set seen(e){var t=this.seen;if(console.log("seen set"),t.length!==e.length||!t.every((t,s)=>t===e[s])){e.length;localStorage.setItem("uvalib-alerts-seen",JSON.stringify(e)),console.log("seen changed "+e.length),this.dispatchEvent(new CustomEvent("seen-count-changed",{bubbles:!0,composed:!0,detail:{seenCount:e.length}})),this.dispatchEvent(new CustomEvent("alerts-changed",{bubbles:!0,composed:!0,detail:{seenCount:e.length}}))}}get seenCount(){return this.seen.length}get alerts(){return Array.isArray(this.lastResponse)&&this.lastResponse.length>0?this.lastResponse.map(function(e){return this.seen&&this.seen.indexOf(e.uuid)>-1?e.seen=!0:e.seen=!1,e}.bind(this)).sort((function(e,t){return e.severity>t.severity})):[]}constructor(){super(),this.path="library-alerts",this.database="https://uvalib-api.firebaseio.com/"}connectedCallback(){super.connectedCallback(),this.addEventListener("uvalib-model-data-value",function(e){this.dispatchEvent(new CustomEvent("alerts-changed",{bubbles:!0,composed:!0}))}.bind(this)),window.addEventListener("storage",function(){this.dispatchEvent(new CustomEvent("seen-count-changed",{bubbles:!0,composed:!0,detail:{seenCount:this.seen.length}}))}.bind(this)),this.dispatchEvent(new CustomEvent("seen-count-changed",{bubbles:!0,composed:!0,detail:{seenCount:this.seenCount}}))}setSeen(e){var t=new Set(this.seen);t.add(e),this.seen=[...t]}setAllUnSeen(){this.seen=[]}setAllSeen(){this.seen=this.alerts.map(e=>e.uuid)}}window.customElements.define("uvalib-model-alerts",t);export default t;
