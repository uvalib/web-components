import"./uvalib-model-ajax.js";import UvalibModelLibrary from"./uvalib-model-library.js";class UvalibModelAlerts extends UvalibModelLibrary{static get observedAttributes(){return super.observedAttributes.concat([])}get alerts(){}get seen(){const e=JSON.parse(localStorage.getItem("uvalib-alerts-seen"));return Array.isArray(e)?e:[]}set seen(e){localStorage.setItem("uvalib-alerts-seen",JSON.stringify(e)),this.dispatchEvent(new CustomEvent("seen-count-changed",{bubbles:!0,composed:!0,detail:{seenCount:e.length}}))}get seenCount(){return this.seen.length}get alerts(){return Array.isArray(this.lastResponse)&&this.lastResponse.length>0?this.lastResponse.map(function(e){return"alert3"===e.severity&&this.setSeen(e.uuid),this.seen&&this.seen.indexOf(e.uuid)>-1?e.seen=!0:e.seen=!1,e}.bind(this)).sort(function(e,t){return e.severity>t.severity}):[]}constructor(){super(),this.path="library/alerts",this.poll=3e5}connectedCallback(){this.addEventListener("last-response-changed",function(e){this.dispatchEvent(new CustomEvent("alerts-changed",{bubbles:!0,composed:!0}))}.bind(this))}setSeen(e){var t=new Set(this.seen);t.add(e),this.seen=[...t]}setAllUnSeen(){this.seen=[]}setAllSeen(){this.seen=this.alerts.map(e=>e.uuid)}}window.customElements.define("uvalib-model-alerts",UvalibModelAlerts);export default UvalibModelAlerts;
